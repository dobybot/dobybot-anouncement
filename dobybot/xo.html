<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Tic‑Tac‑Toe — X / O</title>
    <meta
      name="description"
      content="Simple, accessible Tic‑Tac‑Toe game (X/O)."
    />
    <style>
      :root {
        --bg: #0b1220;
        --card: #071028;
        --accent: #06b6d4;
        --accent-2: #7c3aed;
        --muted: #9aa6bf;
        --win: #16a34a;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
        color: #e6eef8;
        background: linear-gradient(180deg, #061025, #071229 60%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
      }
      .app {
        width: 100%;
        max-width: 760px;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.02),
          rgba(255, 255, 255, 0.01)
        );
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 10px 30px rgba(2, 6, 23, 0.7);
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 16px;
      }
      h1 {
        margin: 0;
        font-size: 20px;
      }
      .sub {
        color: var(--muted);
        font-size: 13px;
      }

      .meta {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      .toggle {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: inherit;
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer;
      }

      .content {
        display: flex;
        gap: 20px;
        margin-top: 20px;
        align-items: flex-start;
      }
      .board {
        display: grid;
        grid-template-columns: repeat(3, 110px);
        grid-template-rows: repeat(3, 110px);
        gap: 10px;
      }
      .cell {
        width: 110px;
        height: 110px;
        border-radius: 10px;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.01),
          rgba(255, 255, 255, 0.02)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 48px;
        color: var(--accent-2);
        cursor: pointer;
        user-select: none;
        border: 1px solid rgba(255, 255, 255, 0.03);
      }
      .cell:focus {
        outline: 3px solid rgba(124, 58, 237, 0.18);
      }
      .cell:hover {
        transform: translateY(-3px);
      }
      .cell.win {
        background: linear-gradient(
          90deg,
          rgba(22, 163, 74, 0.14),
          rgba(124, 58, 237, 0.06)
        );
        box-shadow: 0 8px 20px rgba(22, 163, 74, 0.06);
      }

      .panel {
        min-width: 200px;
      }
      .status {
        background: rgba(255, 255, 255, 0.02);
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 12px;
      }
      .controls {
        display: flex;
        gap: 8px;
        margin-top: 10px;
      }
      .btn {
        background: var(--accent);
        color: #042026;
        padding: 8px 10px;
        border-radius: 8px;
        border: 0;
        font-weight: 700;
        cursor: pointer;
      }
      .btn.secondary {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.06);
        color: var(--muted);
      }
      .scores {
        margin-top: 14px;
        color: var(--muted);
        font-size: 14px;
      }

      @media (max-width: 640px) {
        .content {
          flex-direction: column;
          align-items: center;
        }
        .board {
          grid-template-columns: repeat(3, 76px);
          grid-template-rows: repeat(3, 76px);
        }
        .cell {
          width: 76px;
          height: 76px;
          font-size: 30px;
        }
      }
    </style>
  </head>
  <body>
    <main class="app" aria-live="polite">
      <header>
        <div>
          <h1>Tic‑Tac‑Toe <span class="sub">(X / O)</span></h1>
          <div class="sub">Two-player or play vs CPU (easy)</div>
        </div>
        <div class="meta">
          <button id="modeBtn" class="toggle" aria-pressed="false">
            Play vs CPU: Off
          </button>
          <button id="restartBtn" class="toggle">Restart</button>
        </div>
      </header>

      <section class="content">
        <div>
          <div
            id="board"
            class="board"
            role="grid"
            aria-label="Tic Tac Toe board"
          >
            <!-- cells inserted by JS -->
          </div>
        </div>

        <aside class="panel">
          <div id="status" class="status" role="status">X's turn</div>
          <div class="controls">
            <button id="undoBtn" class="btn secondary" title="Undo last move">
              Undo
            </button>
            <button id="resetScores" class="btn secondary" title="Reset scores">
              Reset scores
            </button>
          </div>
          <div class="scores" id="scores">X: 0 • O: 0 • Draws: 0</div>
        </aside>
      </section>
    </main>

    <script>
      // Simple Tic‑Tac‑Toe game with keyboard accessibility and optional CPU opponent.
      const boardEl = document.getElementById("board");
      const statusEl = document.getElementById("status");
      const modeBtn = document.getElementById("modeBtn");
      const restartBtn = document.getElementById("restartBtn");
      const undoBtn = document.getElementById("undoBtn");
      const resetScores = document.getElementById("resetScores");
      const scoresEl = document.getElementById("scores");

      const WIN_COMBOS = [
        [0, 1, 2],
        [3, 4, 5],
        [6, 7, 8],
        [0, 3, 6],
        [1, 4, 7],
        [2, 5, 8],
        [0, 4, 8],
        [2, 4, 6],
      ];

      let board = Array(9).fill("");
      let turn = "X";
      let gameOver = false;
      let history = [];
      let scores = { X: 0, O: 0, draw: 0 };
      let cpu = false;

      // Load scores
      try {
        const raw = localStorage.getItem("xo-scores");
        if (raw) scores = JSON.parse(raw);
      } catch (e) {
        /* ignore */
      }

      function saveScores() {
        localStorage.setItem("xo-scores", JSON.stringify(scores));
      }

      function renderBoard() {
        boardEl.innerHTML = "";
        board.forEach((v, i) => {
          const btn = document.createElement("button");
          btn.className = "cell";
          btn.setAttribute("role", "button");
          btn.setAttribute(
            "aria-label",
            `Cell ${Math.floor(i / 3) + 1}, ${(i % 3) + 1}`
          );
          btn.dataset.index = i;
          btn.tabIndex = 0;
          btn.textContent = v;
          btn.addEventListener("click", () => onCell(i));
          btn.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              onCell(i);
            }
          });
          boardEl.appendChild(btn);
        });
      }

      function updateStatus(msg) {
        if (msg) statusEl.textContent = msg;
        else statusEl.textContent = `${turn}'s turn`;
      }

      function onCell(i) {
        if (gameOver) return;
        if (board[i]) return;
        makeMove(i);
      }

      function makeMove(i) {
        board[i] = turn;
        history.push(i);
        renderBoard();
        const res = checkWin();
        if (res) {
          handleWin(res);
          return;
        }
        if (board.every((c) => c)) {
          handleDraw();
          return;
        }
        turn = turn === "X" ? "O" : "X";
        updateStatus();
        if (cpu && turn === "O") {
          setTimeout(cpuMove, 350);
        }
      }

      function cpuMove() {
        // random simple CPU
        const empties = board
          .map((v, i) => (v ? null : i))
          .filter((v) => v !== null);
        if (!empties.length) return;
        const choice = empties[Math.floor(Math.random() * empties.length)];
        makeMove(choice);
      }

      function checkWin() {
        for (const combo of WIN_COMBOS) {
          const [a, b, c] = combo;
          if (board[a] && board[a] === board[b] && board[a] === board[c])
            return { winner: board[a], combo };
        }
        return null;
      }

      function handleWin({ winner, combo }) {
        gameOver = true;
        updateStatus(`${winner} wins!`);
        scores[winner] = (scores[winner] || 0) + 1;
        saveScores();
        highlightWin(combo);
        updateScoreDisplay();
      }

      function handleDraw() {
        gameOver = true;
        scores.draw = (scores.draw || 0) + 1;
        saveScores();
        updateStatus("It's a draw");
        updateScoreDisplay();
      }

      function highlightWin(combo) {
        combo.forEach((i) => {
          const btn = boardEl.querySelector(`.cell[data-index='${i}']`);
          if (btn) btn.classList.add("win");
        });
      }

      function restart() {
        board = Array(9).fill("");
        turn = "X";
        gameOver = false;
        history = [];
        renderBoard();
        updateStatus();
      }

      function undo() {
        if (!history.length || gameOver) return;
        const last = history.pop();
        board[last] = "";
        turn = turn === "X" ? "O" : "X";
        renderBoard();
        updateStatus();
      }

      function updateScoreDisplay() {
        scoresEl.textContent = `X: ${scores.X} • O: ${scores.O} • Draws: ${scores.draw}`;
      }

      // UI events
      restartBtn.addEventListener("click", () => {
        restart();
      });
      undoBtn.addEventListener("click", () => {
        undo();
      });
      resetScores.addEventListener("click", () => {
        scores = { X: 0, O: 0, draw: 0 };
        saveScores();
        updateScoreDisplay();
      });

      modeBtn.addEventListener("click", () => {
        cpu = !cpu;
        modeBtn.textContent = `Play vs CPU: ${cpu ? "On" : "Off"}`;
        modeBtn.setAttribute("aria-pressed", cpu);
        if (cpu && turn === "O" && !gameOver) setTimeout(cpuMove, 250);
      });

      // start
      renderBoard();
      updateScoreDisplay();
      updateStatus();

      // keyboard: allow R to restart, U to undo, C to toggle CPU
      window.addEventListener("keydown", (e) => {
        if (e.key.toLowerCase() === "r") restart();
        if (e.key.toLowerCase() === "u") undo();
        if (e.key.toLowerCase() === "c") {
          cpu = !cpu;
          modeBtn.textContent = `Play vs CPU: ${cpu ? "On" : "Off"}`;
          modeBtn.setAttribute("aria-pressed", cpu);
        }
      });
    </script>
  </body>
</html>
